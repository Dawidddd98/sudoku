<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title id="title">Sudoku</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      text-align: center;
      padding: 20px;
      background-color: #fff;
      color: #000;
      transition: 0.3s;
    }
    body.dark {
      background-color: #121212;
      color: #ffffff;
    }
    #sudoku {
      display: grid;
      grid-template-columns: repeat(9, 40px);
      grid-template-rows: repeat(9, 40px);
      margin: 20px auto;
      justify-content: center;
    }
    input {
      width: 40px;
      height: 40px;
      font-size: 18px;
      text-align: center;
      border: 1px solid #999;
      box-sizing: border-box;
    }
    input[disabled] {
      background-color: #ddd;
      font-weight: bold;
    }
    .incorrect {
      background-color: #ffcccc;
    }
    select, button {
      margin: 5px;
      padding: 5px 10px;
      font-size: 14px;
    }
  </style>
</head>
<body>
  <h1 id="title">Sudoku</h1>
  <label id="label-difficulty">Difficulty:</label>
  <select id="difficulty">
    <option value="easy">Easy</option>
    <option value="medium">Medium</option>
    <option value="hard">Hard</option>
  </select>
  <label id="label-language">Language:</label>
  <select id="language" onchange="updateLanguage()">
    <option value="en">English</option>
    <option value="pl">Polski</option>
    <option value="fr">FranÃ§ais</option>
    <option value="es">EspaÃ±ol</option>
    <option value="it">Italiano</option>
    <option value="zh">ä¸­æ–‡</option>
    <option value="ru">Ğ ÑƒÑÑĞºĞ¸Ğ¹</option>
    <option value="pt">PortuguÃªs</option>
  </select>
  <button id="btn-new" onclick="newGame()">New Game</button>
  <button id="btn-theme" onclick="toggleTheme()">ğŸŒ™ Night Mode</button>
  <div>
    <span id="label-time">Time:</span> <span id="time">0</span>s |
    <span id="label-mistakes">Mistakes:</span> <span id="mistakes">0</span>
  </div>
  <div id="sudoku"></div>
  <div id="game-over" style="font-size: 20px; color: red;"></div>

  <script>
    const translations = {
      en: {
        title: "Sudoku", difficulty: "Difficulty:", time: "Time:",
        mistakes: "Mistakes:", new: "New Game", theme: "ğŸŒ™ Night Mode",
        gameOver: "Game Over! ğŸ›‘", language: "Language:"
      },
      pl: {
        title: "Sudoku", difficulty: "Poziom:", time: "Czas:",
        mistakes: "BÅ‚Ä™dy:", new: "Nowa gra", theme: "ğŸŒ™ Tryb nocny",
        gameOver: "Koniec gry! ğŸ›‘", language: "JÄ™zyk:"
      },
      fr: {
        title: "Sudoku", difficulty: "DifficultÃ©:", time: "Temps:",
        mistakes: "Erreurs:", new: "Nouvelle partie", theme: "ğŸŒ™ Mode nuit",
        gameOver: "Fin de partie! ğŸ›‘", language: "Langue:"
      },
      es: {
        title: "Sudoku", difficulty: "Dificultad:", time: "Tiempo:",
        mistakes: "Errores:", new: "Nuevo juego", theme: "ğŸŒ™ Modo noche",
        gameOver: "Â¡Juego terminado! ğŸ›‘", language: "Idioma:"
      },
      it: {
        title: "Sudoku", difficulty: "DifficoltÃ :", time: "Tempo:",
        mistakes: "Errori:", new: "Nuova partita", theme: "ğŸŒ™ ModalitÃ  notte",
        gameOver: "Gioco finito! ğŸ›‘", language: "Lingua:"
      },
      zh: {
        title: "æ•°ç‹¬", difficulty: "éš¾åº¦:", time: "æ—¶é—´:",
        mistakes: "é”™è¯¯æ•°:", new: "æ–°æ¸¸æˆ", theme: "ğŸŒ™ å¤œé—´æ¨¡å¼",
        gameOver: "æ¸¸æˆç»“æŸ! ğŸ›‘", language: "è¯­è¨€:"
      },
      ru: {
        title: "Ğ¡ÑƒĞ´Ğ¾ĞºÑƒ", difficulty: "Ğ¡Ğ»Ğ¾Ğ¶Ğ½Ğ¾ÑÑ‚ÑŒ:", time: "Ğ’Ñ€ĞµĞ¼Ñ:",
        mistakes: "ĞÑˆĞ¸Ğ±ĞºĞ¸:", new: "ĞĞ¾Ğ²Ğ°Ñ Ğ¸Ğ³Ñ€Ğ°", theme: "ğŸŒ™ ĞĞ¾Ñ‡Ğ½Ğ¾Ğ¹ Ñ€ĞµĞ¶Ğ¸Ğ¼",
        gameOver: "Ğ˜Ğ³Ñ€Ğ° Ğ¾ĞºĞ¾Ğ½Ñ‡ĞµĞ½Ğ°! ğŸ›‘", language: "Ğ¯Ğ·Ñ‹Ğº:"
      },
      pt: {
        title: "Sudoku", difficulty: "Dificuldade:", time: "Tempo:",
        mistakes: "Erros:", new: "Novo jogo", theme: "ğŸŒ™ Modo noturno",
        gameOver: "Fim de jogo! ğŸ›‘", language: "Idioma:"
      }
    };

    function updateLanguage() {
      const lang = document.getElementById("language").value;
      const t = translations[lang];
      document.getElementById("title").innerText = t.title;
      document.getElementById("label-difficulty").innerText = t.difficulty;
      document.getElementById("label-time").innerText = t.time;
      document.getElementById("label-mistakes").innerText = t.mistakes;
      document.getElementById("btn-new").innerText = t.new;
      document.getElementById("btn-theme").innerText = t.theme;
      document.getElementById("label-language").innerText = t.language;
      document.getElementById("game-over").innerText = "";

      const levels = {
        en: ["Easy", "Medium", "Hard"],
        pl: ["Åatwy", "Åšredni", "Trudny"],
        fr: ["Facile", "Moyen", "Difficile"],
        es: ["FÃ¡cil", "Medio", "DifÃ­cil"],
        it: ["Facile", "Medio", "Difficile"],
        zh: ["ç®€å•", "ä¸­ç­‰", "å›°éš¾"],
        ru: ["Ğ›ĞµĞ³ĞºĞ¸Ğ¹", "Ğ¡Ñ€ĞµĞ´Ğ½Ğ¸Ğ¹", "Ğ¢ÑĞ¶ĞµĞ»Ñ‹Ğ¹"],
        pt: ["FÃ¡cil", "MÃ©dio", "DifÃ­cil"]
      };
      const opts = document.getElementById("difficulty").options;
      const lbls = levels[lang];
      for (let i = 0; i < opts.length; i++) {
        opts[i].text = lbls[i];
      }
    }

    let correctBoard = "";
    let timer = null;
    let seconds = 0;
    let mistakeCount = 0;

    function toggleTheme() {
      document.body.classList.toggle("dark");
    }

    function generateSudoku(difficulty = "easy") {
      const board = Array.from({ length: 9 }, () => Array(9).fill(0));

      function isSafe(row, col, num) {
        for (let x = 0; x < 9; x++) {
          if (board[row][x] === num || board[x][col] === num) return false;
        }
        const startRow = row - row % 3, startCol = col - col % 3;
        for (let i = 0; i < 3; i++) {
          for (let j = 0; j < 3; j++) {
            if (board[startRow + i][startCol + j] === num) return false;
          }
        }
        return true;
      }

      function fillBoard() {
        for (let row = 0; row < 9; row++) {
          for (let col = 0; col < 9; col++) {
            if (board[row][col] === 0) {
              const nums = shuffle([1,2,3,4,5,6,7,8,9]);
              for (let num of nums) {
                if (isSafe(row, col, num)) {
                  board[row][col] = num;
                  if (fillBoard()) return true;
                  board[row][col] = 0;
                }
              }
              return false;
            }
          }
        }
        return true;
      }

      function shuffle(arr) {
        for (let i = arr.length - 1; i > 0; i--) {
          const j = Math.floor(Math.random() * (i + 1));
          [arr[i], arr[j]] = [arr[j], arr[i]];
        }
        return arr;
      }

      function removeCells(count) {
        while (count > 0) {
          const r = Math.floor(Math.random() * 9);
          const c = Math.floor(Math.random() * 9);
          if (board[r][c] !== 0) {
            board[r][c] = 0;
            count--;
          }
        }
      }

      fillBoard();
      correctBoard = board.map(r => [...r]);

      const blanks = difficulty === "easy" ? 35 : difficulty === "medium" ? 45 : 55;
      removeCells(blanks);

      return board.map(r => r.join("")).join("");
    }

    function newGame() {
      clearInterval(timer);
      seconds = 0;
      document.getElementById("time").innerText = seconds;
      mistakeCount = 0;
      document.getElementById("mistakes").innerText = mistakeCount;
      document.getElementById("game-over").innerText = "";

      const boardStr = generateSudoku(document.getElementById("difficulty").value);
      const container = document.getElementById("sudoku");
      container.innerHTML = "";

      for (let i = 0; i < 81; i++) {
        const input = document.createElement("input");
        const val = boardStr[i];
        const row = Math.floor(i / 9);
        const col = i % 9;
        if (val !== "0") {
          input.value = val;
          input.disabled = true;
        } else {
          input.addEventListener("input", () => {
            const userVal = parseInt(input.value);
            if (userVal === correctBoard[row][col]) {
              input.classList.remove("incorrect");
            } else {
              input.classList.add("incorrect");
              mistakeCount++;
              document.getElementById("mistakes").innerText = mistakeCount;
              if (mistakeCount >= 3) {
                document.getElementById("game-over").innerText = translations[document.getElementById("language").value].gameOver;
                clearInterval(timer);
                document.querySelectorAll("#sudoku input").forEach(i => i.disabled = true);
              }
            }
          });
        }
        container.appendChild(input);
      }

      timer = setInterval(() => {
        seconds++;
        document.getElementById("time").innerText = seconds;
      }, 1000);
    }

    window.onload = () => {
      updateLanguage();
      newGame();
    };
  </script>
</body>
</html>
