<!DOCTYPE html>
<html lang="pl">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Sudoku</title>
  <style>
    :root {
      --bg-color: #f4f4f4;
      --text-color: #000;
      --cell-bg: #fff;
      --selected-cell: #b3d9ff;
      --incorrect-cell: #ffb3b3;
    }
    .dark {
      --bg-color: #1e1e1e;
      --text-color: #fff;
      --cell-bg: #2b2b2b;
      --selected-cell: #0050a0;
      --incorrect-cell: #a00000;
    }
    * { box-sizing: border-box; }
    body {
      font-family: sans-serif;
      background: var(--bg-color);
      color: var(--text-color);
      margin: 0;
      padding: 20px;
      display: flex;
      flex-direction: column;
      align-items: center;
    }
    .controls {
      margin-bottom: 20px;
    }
    .board {
      display: grid;
      grid-template-columns: repeat(9, 70px);
      grid-template-rows: repeat(9, 70px);
      gap: 0;
      border: 4px solid black;
      margin-top: 20px;
    }
    .cell {
      width: 70px;
      height: 70px;
      border: 1px solid #999;
      text-align: center;
      line-height: 70px;
      font-size: 24px;
      font-weight: bold;
      background-color: var(--cell-bg);
      color: var(--text-color);
    }
    .cell.selected {
      background-color: var(--selected-cell);
    }
    .cell.incorrect {
      background-color: var(--incorrect-cell);
    }
    .numbers {
      display: flex;
      justify-content: center;
      flex-wrap: wrap;
      margin-top: 20px;
      gap: 10px;
    }
    .numbers button {
      width: 60px;
      height: 60px;
      font-size: 22px;
    }
    .info {
      margin-top: 20px;
    }
    .lang-select {
      margin-left: 10px;
    }
    /* Bold borders for 3x3 boxes */
    .cell {
      border: 1px solid #999;
    }
    .cell:nth-child(9n+1) {
      border-left: 3px solid black;
    }
    .cell:nth-child(n):nth-child(-n+9) {
      border-top: 3px solid black;
    }
    .cell:nth-child(9n) {
      border-right: 3px solid black;
    }
    .cell:nth-child(n+73) {
      border-bottom: 3px solid black;
    }
    .cell:nth-child(n+28):nth-child(-n+36),
    .cell:nth-child(n+55):nth-child(-n+63) {
      border-bottom: 3px solid black;
    }
  </style>
</head>
<body>
  <div class="controls">
    <button onclick="newGame()" id="newGameBtn">Nowa gra</button>
    <button onclick="newPuzzle()" id="newPuzzleBtn">Nowa plansza</button>
    <select id="difficulty">
      <option value="easy">≈Åatwy</option>
      <option value="medium">≈öredni</option>
      <option value="hard">Trudny</option>
    </select>
    <button onclick="toggleDarkMode()">üåì</button>
    <select id="language" class="lang-select" onchange="setLanguage(this.value)">
      <option value="pl">Polski</option>
      <option value="en">English</option>
      <option value="fr">Fran√ßais</option>
      <option value="es">Espa√±ol</option>
      <option value="it">Italiano</option>
      <option value="ru">–†—É—Å—Å–∫–∏–π</option>
    </select>
  </div>

  <div class="board" id="board"></div>

  <div class="numbers">
    <button onclick="placeNumber(1)">1</button>
    <button onclick="placeNumber(2)">2</button>
    <button onclick="placeNumber(3)">3</button>
    <button onclick="placeNumber(4)">4</button>
    <button onclick="placeNumber(5)">5</button>
    <button onclick="placeNumber(6)">6</button>
    <button onclick="placeNumber(7)">7</button>
    <button onclick="placeNumber(8)">8</button>
    <button onclick="placeNumber(9)">9</button>
  </div>

  <div class="info">
    <p id="mistakes">B≈Çƒôdy: 0/3</p>
    <p id="status"></p>
  </div>

  <script>
    let board = [];
    let solution = [];
    let selectedCell = null;
    let mistakes = 0;

    const translations = {
      pl: { newGame: "Nowa gra", newPuzzle: "Nowa plansza", mistakes: "B≈Çƒôdy", win: "Wygra≈Çe≈õ!", lose: "Przegra≈Çe≈õ!" },
      en: { newGame: "New Game", newPuzzle: "New Puzzle", mistakes: "Mistakes", win: "You win!", lose: "You lost!" },
      fr: { newGame: "Nouvelle partie", newPuzzle: "Nouveau puzzle", mistakes: "Erreurs", win: "Gagn√©!", lose: "Perdu!" },
      es: { newGame: "Nuevo juego", newPuzzle: "Nuevo puzzle", mistakes: "Errores", win: "¬°Ganaste!", lose: "¬°Perdiste!" },
      it: { newGame: "Nuova partita", newPuzzle: "Nuovo schema", mistakes: "Errori", win: "Hai vinto!", lose: "Hai perso!" },
      ru: { newGame: "–ù–æ–≤–∞—è –∏–≥—Ä–∞", newPuzzle: "–ù–æ–≤–∞—è –∑–∞–¥–∞—á–∞", mistakes: "–û—à–∏–±–∫–∏", win: "–í—ã –≤—ã–∏–≥—Ä–∞–ª–∏!", lose: "–í—ã –ø—Ä–æ–∏–≥—Ä–∞–ª–∏!" }
    };

    let currentLang = "pl";

    function setLanguage(lang) {
      currentLang = lang;
      document.getElementById("newGameBtn").textContent = translations[lang].newGame;
      document.getElementById("newPuzzleBtn").textContent = translations[lang].newPuzzle;
      document.getElementById("mistakes").textContent = `${translations[lang].mistakes}: ${mistakes}/3`;
    }

    function toggleDarkMode() {
      document.body.classList.toggle("dark");
    }

    function generateFullBoard() {
      const isValid = (board, row, col, num) => {
        for (let i = 0; i < 9; i++) {
          if (board[row][i] === num || board[i][col] === num) return false;
        }
        const startRow = Math.floor(row / 3) * 3;
        const startCol = Math.floor(col / 3) * 3;
        for (let r = 0; r < 3; r++) {
          for (let c = 0; c < 3; c++) {
            if (board[startRow + r][startCol + c] === num) return false;
          }
        }
        return true;
      };

      const fillBoard = (board) => {
        for (let row = 0; row < 9; row++) {
          for (let col = 0; col < 9; col++) {
            if (board[row][col] === 0) {
              const nums = [1, 2, 3, 4, 5, 6, 7, 8, 9].sort(() => 0.5 - Math.random());
              for (let num of nums) {
                if (isValid(board, row, col, num)) {
                  board[row][col] = num;
                  if (fillBoard(board)) return true;
                  board[row][col] = 0;
                }
              }
              return false;
            }
          }
        }
        return true;
      };

      let newBoard = Array.from({ length: 9 }, () => Array(9).fill(0));
      fillBoard(newBoard);
      return newBoard;
    }

    function createPuzzleFromSolution(solution, difficulty) {
      const clone = JSON.parse(JSON.stringify(solution));
      let empties = { easy: 30, medium: 45, hard: 60 }[difficulty];
      while (empties > 0) {
        let r = Math.floor(Math.random() * 9);
        let c = Math.floor(Math.random() * 9);
        if (clone[r][c] !== 0) {
          clone[r][c] = 0;
          empties--;
        }
      }
      return clone;
    }

    function drawBoard() {
      const boardEl = document.getElementById("board");
      boardEl.innerHTML = "";
      for (let r = 0; r < 9; r++) {
        for (let c = 0; c < 9; c++) {
          const cell = document.createElement("div");
          cell.className = "cell";
          cell.dataset.row = r;
          cell.dataset.col = c;
          if (board[r][c] !== 0) {
            cell.textContent = board[r][c];
            cell.style.pointerEvents = "none";
          } else {
            cell.onclick = () => selectCell(cell);
          }
          boardEl.appendChild(cell);
        }
      }
    }

    function selectCell(cell) {
      if (selectedCell) selectedCell.classList.remove("selected");
      selectedCell = cell;
      cell.classList.add("selected");
    }

    function placeNumber(num) {
      if (!selectedCell) return;
      const row = parseInt(selectedCell.dataset.row);
      const col = parseInt(selectedCell.dataset.col);
      if (solution[row][col] === num) {
        selectedCell.textContent = num;
        selectedCell.classList.remove("incorrect");
        selectedCell.onclick = null;
        selectedCell = null;
        checkWin();
      } else {
        selectedCell.classList.add("incorrect");
        mistakes++;
        document.getElementById("mistakes").textContent = `${translations[currentLang].mistakes}: ${mistakes}/3`;
        if (mistakes >= 3) {
          document.getElementById("status").textContent = translations[currentLang].lose;
          setTimeout(() => newGame(), 3000);
        }
      }
    }

    function checkWin() {
      const cells = document.querySelectorAll(".cell");
      for (let cell of cells) {
        if (cell.textContent === "") return;
      }
      document.getElementById("status").textContent = translations[currentLang].win;
    }

    function newPuzzle() {
      solution = generateFullBoard();
      const diff = document.getElementById("difficulty").value;
      board = createPuzzleFromSolution(solution, diff);
      drawBoard();
    }

    function newGame() {
      mistakes = 0;
      document.getElementById("status").textContent = "";
      setLanguage(currentLang);
      newPuzzle();
    }

    newGame();
  </script>
</body>
</html>
